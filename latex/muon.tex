\documentclass[10pt, oneside, a4paper]{article}   	% {} --> Class: article, report, book, slides
							% [] --> Options: 
							% 11pt = size of the font
							% a4paper, a5paper, letterpaper (default)		
							% titlepage, notitlepage
							% onecolum, twocolumn
							% twoside, oneside = fronteretro o no
							% landscape = foglio orizzontale
								
\usepackage[mode=buildnew]{standalone}
\usepackage[binding=5mm]{layaureo}			% Layout più espanso preimpostato (bindings = spazio rilegatura)
%\usepackage[options]{geometry}             		% Layout completamente configurabile
							
\pagestyle{plain}					% plain (default)     :	stampa i numeri di pagine a piè di pagina nel mezzo. 
								%		           
								% headings            :	stampa l'intestazione del capitolo attuale e il numero di pagina 
								%                   		nell'intestazione di ogni pagina, il piè di pagina resta vuoto
								% empty               : stampa nulla
								
%\usepackage{syntonly}					% Per controllare la sintassi senza produrre pagine, risparmio tempo
%\syntaxonly						% QUESTO effettivamente dice al compilatore di non produrre pagine

\usepackage[hidelinks]{hyperref}					% Collegamenti ipertuestuali (link nell'indice)
\usepackage{graphicx}					% Grafica generale
\usepackage{subfig}					% Subfigures
\usepackage{xcolor}					% Per i colori

\usepackage[italian]{babel}				% Regole di a capo, aggiunta di \ap e \ped per apici e pedici in testo
\usepackage[utf8]{inputenc}				% Specifica la codifica
\usepackage{lmodern}					% Evita "sgranatura" font
\usepackage[T1]{fontenc}				% Risolve i problemi di sillabazione 

\usepackage{microtype}					% Migliora il riempimento delle righe
\usepackage{indentfirst}				% Mette un rientro anche alla prima riga dopo il titolo di paragrafo
%\usepackage[parfill]{parskip}    			% Fa cominciare i paragrafi con una riga vuota piuttosto che con un'indentazione

\usepackage{booktabs}					% Linee separatrici per le tabelle
\usepackage{caption}					% Per mettere la didascalia ben distanziata sopra la tabella
\captionsetup[table]{position=bottom}			% 

\usepackage{amsmath}					% Questo lo ha messo dede
\usepackage{float}					% Questo pure, per fissare la posizione di immagini e tabelle

\usepackage{tikz}
\usepackage{adjustbox}
\usepackage{circuitikz}					% Pacchetti per i disegni dei circuiti

\usepackage{amsmath, amsthm, amssymb, amsfonts}		% Matematica

\usepackage{listings}					% Inserimento di codice
\lstset{language=C++}					% Tutti i codici riconosciuti come c++
\lstset{basicstyle=\small\ttfamily,
keywordstyle=\color{blue}\bfseries,
commentstyle=\color{darkgray},
stringstyle=\color{orange}}				% Colori delle righe di codice


\renewcommand{\epsilon}{\varepsilon}			% Varianti lettere greche usate in Europa
\renewcommand{\theta}{\vartheta}			%
\renewcommand{\rho}{\varrho}				%
\renewcommand{\phi}{\varphi}				%

\usepackage{cleveref}					 % Per avere il simbolo di paragrafo come referenza
\crefname{section}{§}{§§}
\Crefname{section}{§}{§§}

\title{\large{Relazione di Laboratorio Avanzato}\\\Huge{Decadimento dei muoni \\ cosmici in alluminio}}
\date{25 gennaio 2017}
%
%
\begin{document}
\maketitle
\thispagestyle{empty}
%
\vspace{4cm}
\begin{abstract}
	Lo scopo dell'esperienza di laboratorio è di caratterizzare e ottimizzare un apparato sperimentale per la rivelazione dei muoni cosmici, consistente nei suoi componenti fondamentali di scintillatori plastici e fotomoltiplicatori, e di studiare il loro decadimento in alluminio anche tramite lo sviluppo di modelli analitici e simulazioni Monte Carlo. Vengono infine riportati i valori sperimentali delle costanti di decadimento $\tau^+$ e $\tau^-$ delle rispettive particelle muoniche, nonchè il rapporto numerico tra le due popolazioni $N^+/N^-$.
\end{abstract}
\vspace*{\fill}
Mattia Faggin \;\,[1122479] \texttt{mattia.faggin.1@studenti.unipd.it} \\
Davide Piras \;\;\;\:[1114287] \texttt{davide.piras@studenti.unipd.it} \\
Luigi Pertoldi \;\,\,[1128283] \texttt{luigi.pertoldi@studenti.unipd.it}
\cleardoublepage
%
\tableofcontents
\clearpage
\listoffigures
\listoftables
%
\clearpage
\section{Apparato sperimentale}
La parte dell'apparato addetta alla rivelazione dei raggi cosmici (figura~\ref{appScheme}) consiste di cinque barre (\emph{slab}) di materiale plastico poste parallelamente al terreno ($182 \text{ cm}\times21\text{ cm}\times2.58$ cm), distanti 8 cm tra loro, e altre quattro perpendicolari al terreno poste ai lati ($250\text{ cm}\times21\text{ cm}\times2.58$ cm) a chiusura dell'apparato. Le \emph{slab} centrali sono accoppiate alle estremità a due fotomoltiplicatori e sono intervallate da spessori di alluminio di 2 cm; quelle laterali fanno invece riferimento a un unico fotomoltiplicatore presente a una sola estremità. Uno strato formato da lastre di piombo per un totale di circa 1 t ricopre infine la parte superiore dell'apparato: il loro scopo è minimizzare la presenza di altre particelle meno energetiche oltre ai muoni e di frenare questi ultimi al fine di osservarne il decadimento all'interno dell'apparato.
%
\begin{figure}[h]
	\centering
	\include{draw}	
	\caption{Schema dell'apparato di rivelazione. In nero sono rappresentate le barre di alluminio, i numeri etichettano i vari PMT.}
	\label{appScheme}
\end{figure}
%
L'alimentazione è regolata da una serie di partitori di tensione reostatici che permettono di gestire singolarmente il voltaggio dei 14 fotomoltiplicatori. Essi fanno riferimento ad un unico generatore (impostato ad un valore di circa 2100 V, corrispondente alla massima tensione disponibile per ogni fototubo), acceso sempre qualche ora prima di qualsiasi presa dati e mantenuto costantemente in funzione durante l'acquisizione degli spettri analizzati in \cref{analisireale}, in modo tale da poter lavorare nelle condizioni di maggiore stabilità.

I segnali provenienti dai PMT, a polarità negativa, di circa 250 mV di ampiezza e 40 ns di larghezza, vengono formati da 14 discriminatori, per poter essere poi utilizzati negli altri moduli.
%
%
\subsection{Prove di luce - buio}
Il primo controllo eseguito è stato quello relativo alla sensibilità degli scintillatori rispetto alla radiazione ambientale: per ogni fotomotiplicatore si sono raccolti dei conteggi in presenza di luce o in assenza di essa (coprendo l'apparato con teli assorbenti, oscurando le finestre presenti nella stanza e spegnendo le luci) per verificare l'approssimativa indipendenza dell'apparato dalle due situazioni. Eventuali infiltrazioni esterne nel rivestimento assorbente delle \emph{slab} sono state riparate con dello scotch isolante nero. 
%
\begin{figure}[h]
	\centering
	\includegraphics[scale=0.6]{img/luce_buio_100s.pdf}
	\caption{Situazione alla prima presa dati: è evidente la presenza di qualche difetto  nell'involucro della \emph{slab} a ridosso del fotomoltiplicatore n.~12 che permette l'ingresso della radiazione ambientale.}
\end{figure}
%
\subsection{Studio dell'efficienza dei fotomoltiplicatori}
Lo scopo di questa fase consiste nella determinazione dell'efficienza dei 14 fotomoltiplicatori presenti nell'apparato sperimentale. Il comportamento di un generico fotomoltiplicatore, infatti, dipende dalla tensione a cui è alimentato: al crescere della tensione, l'efficienza di rivelazione aumenta sino a saturare a un valore massimo, raggiungendo dunque il regime di \textit{plateau} rispetto ad un contatore di riferimento.
Una volta individuato in quale intervallo di tensioni ciascun fototubo satura, il \emph{set-up} sperimentale ottimale prevede che ciascuno di essi venga alimentato al valore minimo possibile della tensione. 
La condizione di \textit{plateau} è importante per assicurare la massima efficienza di rivelazione possibile; una volta raggiunta, un aumento della tensione di alimentazione coincide solamente con un incremento di rumore.  

L'efficienza di rivelazione corrisponde alla quantità
\[\varepsilon = \frac{T\wedge PMT}{T}\;,\]
dove $T$ corrisponde al numero di eventi rivelati dal cosiddetto \textit{telescopio}, o \textit{trigger}, mentre $T\wedge PMT$ corrisponde alla quantità di eventi rivelati dal fototubo in esame in coincidenza con il telescopio. Il \emph{trigger} prevede l'utilizzo di due \emph{slab} esterne \linebreak ($G$ = grande, $P$ = piccola) poste in coincidenza di volta in volta con alcuni fototubi dell'apparato, differenti da quello momentaneamente esaminato. 

La disposizione del telescopio influenza notevolmente il numero di eventi $T$ tramite i quali si calcola l'efficienza dei diversi fotomoltiplicatori. Ai fini dell'esperimento, l'unica efficienza interessante è relativa alla rivelazione dei raggi cosmici tramite i consueti processi di eccitazione degli atomi del materiale plastico delle \emph{slab}. 
Tuttavia, questa procedura è stata disturbata dalla presenza delle guide di luce di raccordo tra un capo della \emph{slab} e il relativo fototubo: 
avendo a disposizione solo 2 \emph{slab} per formare il telescopio, nel conteggio di trigger entrano, per questioni geometriche, anche quei muoni che attraversano una guida di luce e non le sole \emph{slab}.

In virtù di queste considerazioni, i tracciatori esterni $G$ e $P$ sono stati posizionati sempre parallelamente alle \emph{slab} relative ai PMT esaminati\footnote{$G$ sopra la prima slab, $P$ appoggiata a terra.}: la rivelazione di eventi estranei  
a quelli di interesse\footnote{Cioè non passanti per ambo le \emph{slab} ma attraverso una guida di luce.} 
non modifica l'andamento della curva di efficienza, ma solamente i valori assunti dalla stessa, permettendo comunque di individuare il raggiungimento del regime di \emph{plateau}.

In base al PMT studiato, il telescopio corrisponde ad una delle seguenti configurazioni:
%%%%%%%%%%%%%%%%%%
\begin{itemize}
	\item \textbf{configurazione 1}: per lo studio dei PMT numero 1, 2, 5, 6, 7, 8, 9 e 10 i tracciatori $G$ e $P$ sono messi in coincidenza con i PMT numero 3 e 4 (appartenenti alla \emph{slab} più bassa), cioè \[T = G\wedge P \wedge PMT3 \wedge PMT4 \ ;\]
%
	\item \textbf{configurazione 2}: per lo studio dei PMT numero 3 e 4 i tracciatori $G$ e $P$ sono messi in coincidenza con i PMT numero 1, 2, 5, 6, cioè \[T = G\wedge P \wedge PMT1 \wedge PMT2 \wedge PMT5 \wedge PMT6 \ ; \]
%
	\item \textbf{configurazione 3}: le \emph{slab} laterali sono state momentaneamente tolte dalla loro posizione originale per essere appoggiate, sovrapposte nella stessa direzione e alternate in verso, su sgabelli di eguale altezza. In questo modo, per lo studio dei PMT 11 e 12, posizionati nello stesso verso, i tracciatori $G$, appoggiato sopra la prima delle quattro \emph{slab}, e $P$, appoggiato a terra, sono stati messi in coincidenza con i PMT numero 13 e 14, anch'essi orientati nello stesso verso, opposto ai precedenti. In questo caso: \[T = G\wedge P \wedge PMT13 \wedge PMT14 \ ;\]
%
	\item \textbf{configurazione 4}: questa configurazione coincide con la numero 3, a patto di invertire i ruoli dei PMT 11 e 12 con quelli dei PMT 13 e 14. 
\end{itemize}
%%%%%%%%%%%%%%%%%%%
In appendice sono riportati i grafici relativi allo studio di tutti i 14 fotomoltiplicatori, sia per quanto riguarda la stima delle efficienze da vicino e da lontano, sia per quanto riguarda i conteggi da vicino.

Al numero di eventi in coincidenza $T\wedge PMT$ è assegnata un'incertezza seguente la distribuzione binomiale, di cui si conosce la formula della varianza.  
Si ha allora che 
\[\sigma_{T\wedge PMT} = \sqrt{T \cdot \varepsilon \cdot  (1-\varepsilon)} \ , \]
dove si è assunta come probabilità dell'evento favorevole il valore sperimentale dell'efficienza $\varepsilon$.
L'errore sull'efficienza è dunque:
$$\sigma_\epsilon=\sqrt{ \left(\frac{\partial\epsilon}{\partial (T\wedge PMT)}\sigma_{T\wedge PMT}\right)^2 + \left(\frac{\partial \epsilon}{\partial T}\sigma_T\right)^2 }=\sqrt{\frac{\epsilon}{T}} \ , $$
dove $\sigma_T = \sqrt{T}$.

%
\subsection{Misure di differenze temporali}\label{tac}
L'acquisizione della curva di decadimento dei muoni necessita di una procedura per la misura di intervalli temporali tramite un modulo Time to Amplitude Converter (TAC) e un modulo Analog to Digital Converter (ADC) per la conversione digitale. Le proprietà desiderate della catena elettronica devono essere opportunamente verificate prima di eseguire una procedura di calibrazione che permetta di associare un canale del multicanale ad un ben preciso valore temporale.

Inizialmente si è verificato il corretto comportamento della catena TAC + ADC rispetto a una distribuzione uniforme di ritardi temporali, ovvero generando due treni di segnali artificiali scorrelati da mandare in input alle entrate di START e STOP del TAC; ci si aspetta dalla raccolta di un numero statisticamente rilevante di dati una distribuzione perfettamente piatta. Per l'esperimento si è scelto di utilizzare il TAC n.~437 disponibile in laboratorio: in figura~\ref{rumore1} è possibile osservare i risultati di una prima acquisizione.
%
\begin{figure}[h]
  \centering  
  \includestandalone[width=10cm]{img/bkg437}
  \caption{Prima analisi dello spettro di ritardi temporali con START e STOP artificiali scorrelati; si nota la presenza di un eccesso di eventi indesiderato nell'intervallo $[2200,2700]$ (è stato applicato un rebin di un fattore 12 per evidenziare meglio la situazione).}
  \label{rumore1}
\end{figure}
%

Il TAC n.~437 sembra presentare due problemi, un picco all'inizio dello spettro di cui non si è scoperta l'origine, ma che non influisce sulla raccolta dati e un eccesso di eventi nell'intervallo $[2200,2700]$. Questo secondo problema, di origine anch'essa ignota, rappresenta invece un potenziale fattore di disturbo per l'analisi dati, Un possibile approccio alla risoluzione verrà presentato in \cref{analisireale}.

Dopo questa prima fase si è verificato che il TAC  non erogasse più di 5 V (il massimo valore di tensione convertibile dall'ADC) in corrispondenza di un ritardo di 20 $\mu$s. Si è proceduto quindi a verificare la linearità della catena elettronica TAC + ADC e a ottenere una calibrazione temporale dello spettro registrato dal multicanale: tramite due copie del segnale di un impulsatore opportunamente discriminato fornite in input al TAC, separate da una distanza temporale variabile nel range $[0 \ \mu \mbox{s},20 \ \mu \mbox{s}]$, si sono registrati i relativi valori di tensione erogati e il canale corrispondente (per i grafici delle calibrazioni si veda appendice B, figure~\ref{time_tens} e~\ref{chan_time}).

Con il fondoscala impostato come descritto in precedenza, il TAC eroga per valori del ritardo compresi tra 60 ns e 20 $\mu$s segnali nei range di tensione $[0.211 \ \mbox{V}, 5.070 \ \mbox{V}]$.
%
%
\section{Operazioni preliminari alla presa dati}
\subsection{Conteggi in coincidenza}
La fase di studio successiva consiste nel raccogliere i conteggi in coincidenza tra varie \emph{slab} e conseguentemente ottimizzare i valori di tensione applicata ai fotomoltiplicatori al fine di ottenere valori consistenti tra loro e in linea con le previsioni teoriche (vedi appendice A). 
Innanzitutto, si sono scelti i seguenti valori di tensione dei PMT: 
\begin{table}[H]
		\centering
	\begin{tabular}{ccc}
		\toprule
		PMT	&	HV [V]	&	Frequenza [Hz]\\	
		\midrule
		1	&	1860	&	109	\\
		2	&	1940	&	91	\\
		3	&	1930	&	100	\\
		4	&	1920	&	121	\\
		5	&	1890	&	121	\\
		6	&	1950	&	105	\\
		7	&	1770	&	123	\\
		8	&	1890	&	173	\\
		9	&	1670	&	128	\\
		10	&	1810	&	101	\\
		11	&	1750	&	124	\\
		12	&	1840	&	82	\\
		13	&	1960	&	86	\\
		14	&	1800	&	197	\\
		\bottomrule
	\end{tabular}
	\caption{Tensione finale applicata ai fotomoltiplicatori e relativo numero di conteggi con il piombo posizionato; l'incertezza associata a ciascuna frequenza è di 1 Hz. Le tensioni scelte garantiscono la condizione di \emph{plateau} da distante rispetto al fototubo. Nel corso dei mesi tali tensioni e frequenze sono state costantemente monitorate, oscillando sempre entro le incertezze.}
	\label{HV_counts}
\end{table}
Si sono quindi raccolti i dati di varie coincidenze, prima senza e poi sovrapponedo il piombo, per testare la diminuzione di eventi rivelati in presenza delle lastre, e verificare che la geometria dell'apparato fosse consistente con il numero di eventi raccolti. I simboli L e R indicano rispettivamente R $= 14 \vee 11 $ e L $= 12 \vee 13$, e insieme alla coppia di PMT 3 e PMT 4 (cioè, S5) formano la cosiddetta \emph{scatola}, utile per i circuiti di START e STOP, analizzati nel paragrafo successivo.
%
\begin{table}[H]
	\centering
	\begin{tabular}{ccc}
		\toprule
		Coincidenze						&	Frequenza senza Pb [Hz] & Frequenza con Pb [Hz]	\\
		\midrule
		S1 (PMT1 $\wedge$ PMT2)					& $60.6 \pm 0.8$	& $52.0 \pm 0.7$ \\
		S2 (PMT9 $\wedge$ PMT10)				& $64.1 \pm 0.8$	& $60.0 \pm 0.8$ \\
		S3 (PMT7 $\wedge$ PMT8)					& $77.2 \pm 0.9$	& $75.1 \pm 0.9$ \\
		S4 (PMT5 $\wedge$ PMT6)					& $63.4 \pm 0.8$	& $61.5 \pm 0.8$ \\
		S5 (PMT3 $\wedge$ PMT4)					& $61.1 \pm 0.8$	& $60.3 \pm 0.8$ \\
		S1 $\wedge$ S2 						& $39.0 \pm 0.6$	& $36.2 \pm 0.6$ \\
		S2 $\wedge$ S3 						& $37.9 \pm 0.6$    	& $36.4 \pm 0.6$ \\
		S3 $\wedge$ S4 						& $37.5 \pm 0.6$	& $36.3 \pm 0.6$ \\
		S4 $\wedge$ S5 						& $36.0 \pm 0.6$	& $35.3 \pm 0.6$ \\
		S1 $\wedge$ S3 						& $29.2 \pm 0.5$	& $26.9 \pm 0.5$ \\
		S1 $\wedge$ S4 						& $22.9 \pm 0.5$	& $21.0 \pm 0.5$ \\
		S1 $\wedge$ S5 						& $17.7 \pm 0.4$	& $16.0 \pm 0.4$ \\
		S1 $\wedge$ S2 $\wedge$ S3				& $29.1 \pm 0.5$	& $27.5 \pm 0.5$ \\
		S2 $\wedge$ S3 $\wedge$ S4				& $28.7 \pm 0.5$	& $27.8 \pm 0.5$ \\
		S3 $\wedge$ S4 $\wedge$ S5				& $28.6 \pm 0.5$	& $27.6 \pm 0.5$ \\
		S1 $\wedge$ S2 $\wedge$ S3 $\wedge$ S4			& $21.8 \pm 0.5$	& $21.8 \pm 0.5$ \\
		S2 $\wedge$ S3 $\wedge$ S4 $\wedge$ S5			& $20.8 \pm 0.5$	& $21.0 \pm 0.5$ \\
		S1 $\wedge$ S2 $\wedge$ S3 $\wedge$ S4 $\wedge$ S5	& $16.7 \pm 0.4$	& $16.7 \pm 0.4$ \\	
		S1 $\wedge$ S2 $\wedge$ L				& $8.9 \pm 0.3$		& $8.8 \pm 0.3$	\\
		S1 $\wedge$ S2 $\wedge$ R				& $8.4 \pm 0.3$		& $7.7 \pm 0.3$	\\
		S3 $\wedge$ S4 $\wedge$ L				& $7.5 \pm 0.3$		& $8.0 \pm 0.3$	\\
		S3 $\wedge$ S4 $\wedge$ R				& $9.2 \pm 0.3$ 	& $9.3 \pm 0.3$	\\
		S1 $\wedge \ (\overline{\mbox{S5}\vee \mbox{L} \vee \mbox{R}})$ (veto)	& $51.3 \pm 0.7$	& $43.2 \pm 0.7$	\\
		\bottomrule
	\end{tabular}
	\caption{Coincidenze. 
	Si noti che nell'ultima misura si è utilizzato il veto per negare il segnale, 
	in quanto esso è risultato più efficiente dell'uscita negata dei discriminatori 
	nell'individuare il segnale voluto: talvolta, infatti, l'uscita negata dei discriminatori non forniva in uscita il segnale desiderato, 
	probabilmente a causa di un malfunzionamento dei moduli o di un problema nella temporizzazione dei segnali. Per ovviare a ciò, con riferimento all'ultima coincidenza,
	si è messo il segnale $S5\vee L\vee R$ (opportunamente temporizzato)
	nell'ingresso di veto del discriminatore del 
	segnale $S1$: qualora il veto sia attivo, l'output 
	risulta nullo.}
	\label{coincidenze}
\end{table}
%
\subsection{Costruzione del circuito}
A questo punto, dopo tutte le verifiche necessarie, e dopo aver ripetuto le prove di luce-buio\footnote{Si è notato un eccesso di segnale proveniente da una zona della \emph{slab} superiore, subito risolto con del nastro isolante.}, si sono costruiti i circuiti di START e di STOP, per la rivelazione dei muoni cosmici. Si rende però necessario fare una premessa: potendo utilizzare nella costruzione del circuito segnali negati o di veto, dopo alcune prove si è optato per la seconda possibilità, avendo cura di temporizzare bene le coincidenze, ossia facendo in modo che il segnale di veto, se presente, rendesse effettivamente cieco l'apparato. In questo passaggio il segnale di veto è stato ritardato e allargato cosicchè contenesse il segnale del PMT in coincidenza.

Per il segnale di START, corrispondente al muone che entra dall'alto e non esce dalla scatola, si è partiti considerando varie possibilità; il miglior compromesso, che generasse un segnale sufficientemente pulito ma con una frequenza di conteggio non troppo bassa, si è rivelato essere il segnale S1 $\wedge$ S2  $\wedge$ $\overline{\mbox{S5}\vee \mbox{L} \vee \mbox{R}}$ , la cui frequenza in coincidenza è 6.6 Hz.
Il segnale di STOP corrisponde invece all'avvenuto decadimento e rivelazione dell'elettrone emesso, ed è stato scelto essere (S3 $\veebar$ S4)  $\wedge$ $\overline{\mbox{S1} \vee \mbox{S5}\vee \mbox{L} \vee \mbox{R}}$, con frequenza 38.1 Hz (schemi in figura~\ref{scemi}).

A questo punto, con i segnali START e STOP fisici si sono ripetute i test di uniformità descritti alla sezione~\ref{tac} utilizzando START artificiale con STOP fisico e viceversa. Si riscontra lo stesso eccesso di eventi attorno al canale 2500 individuato durante la caratterizzazione del TAC.
%
\begin{figure}[h]
	\centering
	\include{Scemi}
	\caption{Schema dei circuiti di START e di STOP. Si noti che nel circuito di STOP si è utilizzato un segnale di XOR, ossia il veto ha una componente che rende cieco l'apparato quando entrambe le \emph{slab} S3 e S4 rivelano un evento; ciò viene utilizzato per cercare di incrementare la probabilità che il segnale di STOP non sia dato da un evento spurio, assumendo che una volta decaduto il muone l'elettrone si fermi alla prima \emph{slab} che incontra.}
	\label{scemi}
\end{figure}
%
\section{Analisi dati preliminare}
\label{analPrelim}
Dopo aver impostato il circuito come illustrato precedentemente, si è proceduto all'acquisizione dei dati relativi al ritardo che intercorre tra il passaggio del muone cosmico rivelato dallo START e l'uscita dell'elettrone di decadimento rivelato dallo STOP.

I dati consistono di tre acquisizioni, per un totale di circa 75000 eventi, riguardanti due popolazioni differenti di muoni\footnote{I valori attesi sono ricavati da: 
\begin{itemize}
\item $\tau_{+}$:  K.~A. Olive \emph{et al.}, \emph{Particle Data Group}, Chin. Phys. \textbf{C38}, 090001 (2014);
\item $\tau_{-}$: A. Grossheim \emph{et al.}, \emph{Decay of negative muons bound in $^{27}$Al}, Phys.Rev., \textbf{D80}, 052012 (2009); 
\item R: T.~H. Burnett \emph{et al.}, \emph{Measurement of cosmic-ray muon charge ratio at sea level between energies of 10 and 1500 GeV}, Phys.Rev.Lett., \textbf{30}, 937 (1973).
\end{itemize}}:
\begin{itemize}
	\item i $\mu^+$, tali che $\mbox{Br}(\mu^+ \to e^+\nu_e\overline{\nu}_\mu)\simeq 100 \%$ e aventi una vita media \linebreak $\tau^+=(2.1969811 \pm 0.0000022)\;\mu\mbox{s}$;
\item i $\mu^-$, i quali però si comportano in maniera differente. Essi, infatti, oltre a decadere nel canale $\mu^-\to e^-\overline{\nu}_e\nu_\mu$, possono sostituirsi ad un elettrone degli atomi del mezzo, formando un atomo muonico in uno stato metastabile che favorisce il processo di cattura $\mu^-+p\to n+\nu_\mu $, con $p$ protone del nucleo del mezzo. Questo implica una diminuzione della vita media per i $\mu^-$ al valore $\tau^-=(0.8646 \pm 0.0012) \ \mu \mbox{s}$.
\end{itemize}

I vari contributi possono essere convogliati nella seguente formula, che modellizza lo spettro che si ottiene tramite l'ADC:
 \[  \frac{dN}{dt} = A^+ e^{-t/\tau^+} + A^- e^{-t/\tau^-} + \mbox{\emph{b\;.}} \]
Queste due popolazioni vanno ovviamente considerate in maniera separata, sapendo che lo spettro raccolto prevede una prima parte relativa ai $\mu^-$ (per $t\lesssim4\tau^-$), una seconda parte relativa ai soli $\mu^+$ (per $4\tau^-\lesssim t\lesssim 4\tau^+$) ed infine puro fondo $b$ (per $t\gtrsim4\tau^+$), distinguibili grazie alla calibrazione temporale del sistema TAC+ADC.

L'analisi dati si svolge in base ai seguenti step:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{enumerate}
	\item si definisce un istogramma con 4096 canali, nel quale inserire tutta la statistica raccolta, assegnando a ciascun bin un contenuto pari alla somma dei contenuti del medesimo canale delle varie acquisizioni (in questo caso 3);
	\item si stima il fondo come la media tra i contenuti dei bin a partire da quello che, in base alla calibrazione, coincide con $t\sim 4\tau^+$, e tale valore si sottrae al contenuto di ciascun bin;
	\item si definisce la funzione $f(t)=Ae^{-t/\tau}$, dove la variabile indipendente $t$ e $\tau$ si riferiscono a grandezze in canali; quindi si esegue un fit dell'istogramma nella regione dei soli $\mu^+$. Questa operazione permette di ricavare sia la vita media $\tau^+$ sia il parametro $A^+$ dei $\mu^+$; 
	\item al contenuto di ciascun canale dell'istogramma si sottrae il valore assunto dalla funzione suddetta in corrispondenza del centroide di ciascun canale, in modo tale da ricavare la distribuzione dei soli $\mu^-$;
	\item si effettua il fit dell'istogramma risultante, ricavando i parametri relativi ai $\mu^-$.
\end{enumerate}
%%%%%%%%%%%%%mico %%%%%%%%%%%%%%%%%
Questo procedimento presenta tuttavia un aspetto critico, da mettere a punto nella seconda parte dell'esperienza: il fit della regione relativa ai $\mu^+$ riguarda canali dell'istogramma con bassa statistica e questo provoca una notevole fluttuazione dei risultati, in particolare al variare del fattore di \emph{rebin} (il quale verrà studiato in maniera più approfondita nel \cref{parrebin}).

Per quanto riguarda il rapporto numerico $N^+/N^-$ tra le due popolazioni, la stima è stata ottenuta tramite la seguente formula: 
\begin{equation}
\frac{A^+}{A^-}= \bigg ( \frac{\tau^+}{\tau^-} \bigg )  ^{-1} \frac{N^+}{N^-} \bigg ( \frac{\Gamma_d}{\Gamma_d+\Gamma_c} \bigg )^{-1}\sim\frac{N^+}{N^-}\;,
\label{eq:R}%
\end{equation}
dove $\Gamma_d$ e $\Gamma_c$ sono rispettivamente le larghezze parziali di decadimento e cattura per entrambe le popolazioni. 
Si noti che nel nostro caso si è deciso di utilizzare la calibrazione del TAC per stabilire il punto di inizio dell'istogramma (che corrisponde al canale 150), mentre il primo canale dello spettro è in corrispondenza del canale 168; di conseguenza, si è traslato l'istogramma di 150 canali, notando che i 18  rimanenti corrispondono a un intervallo di circa 100 ns in cui l'apparato è cieco.
Lavorando in canali, la procedura di fit attuata su uno spettro che non cominci dal canale corrispondente a un ritardo nullo avrebbe richiesto l'aggiunta, nella formula sperimentale \ref{eq:R}, di un fattore
\[e^{t^*\left(\frac{1}{\tau^+}-\frac{1}{\tau^-}\right)}\;,\]
con $t^*$ relativo  al canale corrispondente a un ritardo nullo.

Dopo questa operazione lo spettro presenta dati dal canale 18 al canale 3903, intervallo in cui è stato applicato l'algoritmo di fit. 

%
\begin{figure}[h!]
\centering
\subfloat[][{Eventi raccolti.}]
{\includegraphics[width=1\textwidth]{img/Spettro_rebin12.pdf}} \\
\subfloat[][{Istogrammi sovrapposti}.]
{\includegraphics[width=1\textwidth]{img/histo_sovrapposti.pdf}} \\
\caption{Istogrammi dei dati raccolti e analizzati secondo quanto spiegato precedentemente, con un coefficiente di \emph{rebin} 12.}
\label{fig::histo}
\end{figure}
%
In figura~\ref{fig::histo} viene riportato il grafico degli eventi raccolti, dove l'istogramma ha un numero di \emph{bin} ridotto di un fattore 12 rispetto a quello originale per ridurre le fluttuazioni statistiche in maniera ottimale. I risultati derivanti da questa analisi sono riportati in tabella~\ref{results}.
%
\begin{table}[H]
	\centering
	\begin{tabular}{cccc}
		\toprule
				& Misura	& Valore atteso 	& Compatibilità \\	
		\midrule
		$\tau^+$	& $(2.20 \pm 0.05) \ \mu \mbox{s}$ 	& $(2.1969811 \pm 0.0000022) \  \mu \mbox{s}$ 	& 0.06 	\\
		$\tau^-$	& $(0.870 \pm 0.007)  \ \mu \mbox{s}$ 	& $(0.8646 \pm 0.0012)  \ \mu \mbox{s}$ 		& 0.76	\\
		$N^+/N^-$	& $1.5 \pm 0.1$ 	& $1.261 \pm 0.009$ 		& 2.38	\\
		\bottomrule
	\end{tabular}
	\caption{Risultati dell'analisi preliminare.}
	\label{results}
\end{table}
%
%\begin{table}[h!]
%	\centering
%	\begin{tabular}{ccccc}
%		\toprule
%		& Misura [$\mu$s]	&	Valore atteso [$\mu$s]	 & Compatibilità & Differenza [$\mu$s]	\\	
%		\midrule
%		$\tau^+$	&	$2.20\pm 0.05$ & $2.1969811 \pm 0.0000022$ & 0.16 & 0.0072134	\\
%		$\tau^-$	&	$0.870\pm 0.007$ & $0.88 \pm 0.01$ & 0.80 & 0.01	\\
%		$N^+/N^-$	&	$1.5 \pm 0.1$ & $1.261 \pm 0.009$ & 1.95 & 0.20	\\
%		\bottomrule
%	\end{tabular}
%	\caption{Risultati dei fit (rebin 12).}
%	\label{results}
%\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\cleardoublepage
\section{Simulazione Monte Carlo e analisi dati}
Lo scopo di questa fase dell'esperimento consiste nella ricerca e messa a punto di un metodo sperimentale di analisi degli spettri raccolti. Il lavoro si suddivide in due step:
\begin{enumerate}
 \item sviluppare un codice di simulazione Monte Carlo (MC) in ambiente ROOT nel quale si simulano molti spettri di decadimento dei muoni cosmici in un range utile di circa 3900 canali, in accordo con gli spettri acquisiti. Gli istogrammi simulati vengono quindi utilizzati per testare diversi metodi di fit per l'estrazione dei parametri fisici;
 \item utilizzare il metodo di fit stabilito nello step precedente per estrarre $\tau^+$, $\tau^-$ e $R=N^+/N^-$ dagli spettri raccolti.
\end{enumerate}
%
\subsection{Simulazione del fondo}
La prima versione del metodo MC prevede la simulazione di spettri costituiti da solo rumore di fondo (avente una distribuzione uniforme su tutto lo spettro che da ora in avanti chameremo anche \textit{baseline}), attraverso la generazione uniforme di numeri casuali (\lstinline{TRandom3::Uniform(double Begin,double End)}). 
I metodi testati per la stima della \textit{baseline} sono i seguenti:
\begin{enumerate}
 \item media aritmetica dei contenuti dei bin dell'istogramma \lstinline{baseline};
 \item fit con il metodo del $\chi^2$ utilizzando la funzione \lstinline{pol0} (\lstinline{baseline.Fit("pol0")});
 \item metodo della maximum likelihood utilizzando la funzione \newline \lstinline{pol0} (\lstinline{baseline.Fit("pol0","L")}).
\end{enumerate}
%
\begin{figure}[H]
 \centerline{\includestandalone[width=\linewidth+1cm]{img/baseline}}
 \caption{Distribuzioni delle stime della \textit{baseline} con i tre metodi differenti, sia per i valori sia per gli errori (500 simulazioni). La \textit{baseline} generata in queste simulazioni ha altezza 10.}\label{fig::baseline_500}
\end{figure}
%
In figura~\ref{fig::baseline_500} è riportato un esempio delle distribuzioni dei valori e degli errori derivanti da simulazioni multiple, stimati con i tre metodi. La linea rossa verticale nei grafici in alto indica il valore vero della \textit{baseline}, ossia il valore con cui sono stati simulati gli spettri, quindi il valore che dovrebbe essere restituito dall'analisi. Come si può notare, la distribuzione dei valori estratta con fit \lstinline{pol0} di tipo $\chi^2$ non è centrata attorno al valore atteso. In questo caso, infatti, la baseline è sistematicamente sottostimata, poichè:
\begin{enumerate}
 \item il metodo dei minimi quadrati non funziona correttamente per il fit di un istogramma con bin a bassa statistica, per i quali l'assegnazione di errore di tipo poissoniano (cioè la radice del conteggio) presenta delle criticità, in particolare per contenuti nulli;
 \item il fit di una \lstinline{pol0} con il metodo del $\chi^2$ corrisponde esattamente ad una media pesata, nella quale i bin con statistica minore hanno un peso maggiore, con conseguenti valori sottostimati della \textit{baseline}\footnote{Media pesata ed errore:
$$\bar{b}=\frac{\sum_{i=1}^N b_i/\sigma_i^2}{\sum_{i=1}^N 1/\sigma_i^2};
\hspace{1cm} \sigma_{\bar{b}}=\frac{1}{\sum_{i=1}^N1/\sigma_i^2}$$}.
 
\end{enumerate}
In virtù di queste considerazioni, il metodo di fit del $\chi^2$ è stato dunque scartato. 
Gli spettri relativi agli errori statistici sulla \textit{baseline} sono utili per controllare che le distribuzioni dei valori non siano troppo disperse. In altre parole, si effettua il confronto tra la $\sigma$ delle gaussiane dei valori e il centroide $\overline{\sigma_{b}}$ delle gaussiane degli errori, controllando che $\sigma\lesssim \overline{\sigma_{b}}$, condizione soddisfatta nelle simulazioni in esame. 

Dato che inoltre risulta che il metodo della media ha una dispersione attorno al centroide leggermente più alta rispetto al metodo della likelihood, si preferisce da qui in poi l'utilizzo di quest'ultimo.

%
\subsection{Simulazione del fondo e del primo esponenziale} \label{bexp}
Una seconda versione del metodo Monte Carlo prevede di studiare una distribuzione contenente un termine costante e un termine esponenziale. 
\begin{equation}
 f(t;A,\tau,b)=Ae^{-\frac{t}{\tau}}+b .
 \label{eq::exp_plus_base}
\end{equation}
Per la costruzione delle distribuzioni si è scelto di generare indipendentemente la distribuzione uniforme con \lstinline{TRandom3::Uniform} e la distribuzione esponenziale con \lstinline{TRandom3::Exp}, per poi sommarle. Avendo stabilito che il metodo della maximum likelihood è il più stabile e predittivo si sono studiati diversi approcci al fit della distribuzione:
\begin{enumerate}
  \item fit diretto con la funzione completa impostando $\tau$ al valore vero e lasciando $A$ e $b$ non inizializzati;
  \item fit di tipo \lstinline{pol0} della parte finale dello spettro per la stima di $b$, utilizzata in secondo luogo per inizializzare il corrispondente parametro nel fit con la funzione completa del metodo precedente;
  \item fit di tipo \lstinline{pol0} della parte finale dello spettro per la stima di $b$, quindi sottrazione della componente costante della distribuzione e successivo fit puramente esponenziale.
\end{enumerate}
Dei tre metodi il secondo si è rivelato il più stabile; un fit a tre parametri, infatti, necessita di valori di partenza che siano sufficientemente vicini al valore vero affinchè l'algoritmo di massimizzazione della likelihood vada a convergenza correttamente, e ciò ci porta a scartare il primo metodo, poco stabile con valori iniziali distanti dal valore vero. Anche il terzo metodo presenta delle criticità aggiuntive rispetto al secondo: in primo luogo una sottrazione di dati a bassa statistica può facilmente portare ad avere canali a contenuto negativo (privo di significato fisico); in secondo luogo, come si può notare dalla figura~\ref{baselinestart}, il fit della \textit{baseline} sovrastima il valore di $b$ e perciò la sottrazione porterebbe certamente a un errore sistematico nel fit successivo.

L'adozione del secondo metodo richiede la scelta del canale (valore di ritardo temporale) dal quale far iniziare il fit della porzione di \textit{baseline}: si è quindi proceduto a eseguire uno studio sistematico dei risultati al variare di questo estremo inferiore, confrontando le medie su più simulazioni (figura~\ref{baselinestart}). Dal grafico è evidente come la riscostruzione sia più precisa ma meno accurata per piccoli valori e di come la situazione si inverta per grandi valori. A priori si potrebbe scegliere un valore che rappresenti la via di mezzo tra queste due situazioni, ma a posteriori, studiando la ricostruzione di $b$ e $\tau^+$ dopo il fit esponenziale del metodo 2, si è verificato con varie prove come la scelta di questo valore iniziale sia del tutto ininfluente sulla bontà della convergenza ai parametri impostati in input.
%
\begin{figure}[h]
  \centerline{\includestandalone[width=\linewidth+1cm]{img/tprofile}}
  \caption{Studio della ricostruzione della \textit{baseline} $b$ al variare del punto di inizio del fit costante di tipo \texttt{pol0}: in alto i valori ottenuti (la linea rossa rappresenta il valore vero) e in basso i rispettivi errori. Le barre di errore rappresentano la deviazione standard del campione di 100 simulazioni utilizzato. I dati utilizzati nella generazione corrispondono a 1 settimana di acquisizione.}\label{baselinestart}
\end{figure}
%
\subsection{Simulazione del fondo e di entrambi gli esponenziali}
Il metodo Monte Carlo prevede ora di studiare una distribuzione contenente un termine costante di \textit{baseline} e due esponenziali:
\begin{equation}
 f(t;A_+,\tau^+,A_-,\tau^-, b)=A_-e^{-\frac{t}{\tau^-}}+A_+e^{-\frac{t}{\tau^+}}+b
 \label{eq::funzione_fit_finale}
\end{equation}
La distribuzione esponenziale relativa ai $\mu^-$ viene generata con \lstinline{TRandom3::Exp} separatamente da quella dell'esponenziale dei $\mu^+$ e della \textit{baseline}, sommando infine le distribuzioni in un unico istogramma, come nel paragrafo~\cref{bexp}. 

L'adozione del metodo 2 descritto in precedenza prevede uno studio accurato del canale (i.e. del ritardo temporale) dal quale cominciare il fit della funzione $A_+e^{-\frac{t}{\tau^+}}+b$. 
\begin{figure}[h]
  \centerline{\includestandalone[width=\linewidth+1cm]{img/fitbegin_5week_100sim}}
  \caption{Studio della stima di $\tau_+$ al variare del punto di inizio del fit $A_+e^{-\frac{t}{\tau^+}}+b$. La linea rossa rappresenta il valore vero impostato nella simulazione. Le barre d'errore rappresentano la deviazione standard del campione di 100 simulazioni utilizzate. I dati utilizzati nella generazione corrispondono a 5 settimane di acquisizione.}
  \label{fig::tauplusstart}
\end{figure}
Come riportato in figura~\ref{fig::tauplusstart}, il fit \textit{baseline}+esponenziale produce un valore di $\tau^+$ che è sempre sottostimato rispetto al valore vero: perciò, non essendovi alcun caso particolare, come estremo inferiore di fit di questa funzione si è scelto un valore in canali corrispondente a $5\tau^-  {\raise.17ex\hbox{$\scriptstyle\sim$}} \  4.4  \ \mu s$, dopo il quale la popolazione di $\mu^+$ è pressochè assente.

Iil metodo di fit messo a punto prevede i seguenti step:
\begin{enumerate}
 \item fit (\lstinline{pol0}) della coda dello spettro con estrazione del valore preliminare $B$ per la \textit{baseline};
 \item definizione della funzione \lstinline{TH1 f1} corrispondente alla formula~\ref{eq::exp_plus_base}, \emph{setting} del parametro $b$ al valore derivante dal fit del punto precedente (\lstinline{f1.SetParameter("b",B)}) e realizzazione del fit dell'istogramma con \lstinline{f1} a partire da un ritardo di $5\tau^-$ (in questo modo si ottengono le stime intermedie $\widetilde{\tau}$  e $\widetilde{B}$ per i parametri $\tau^+$ e \textit{baseline}, rispettivamente);
 \item definizione della funzione complessiva di fit \lstinline{TH1 f} corrispondente alla formula~\ref{eq::funzione_fit_finale}, \emph{setting} dei parametri $\tau^+$ e \textit{baseline} ai valori  $\widetilde{\tau}$  e $\widetilde{B}$ e, infine, fit dell'istogramma con la funzione \lstinline{f}, con estrazione dei valori definitivi dei parametri. 
%
\end{enumerate}  
Concludendo, la generazione degli spettri utilizza i seguenti parametri di input:
$$\tau^+,\tau^-,R,b,I$$
dove $I$ è l'integrale della distribuzione. Questi parametri sono tra loro legati dalle seguenti relazioni:
\begin{equation}
 \begin{cases}
  I = \int\limits_{t_0}^\infty f(t) = A_-\tau^-e^{-t_0 / \tau^-} + A_+\tau^+e^{-t_0 / \tau^+} + b\cdot r \\
  R = \frac{A^+}{A^-} \\
 \end{cases}
 \label{eq::condizioni_parametri}
\end{equation}
dove 
\begin{itemize}
 \item $f(t) = dN/dt$ corrisponde alla formula~\ref{eq::funzione_fit_finale};
 \item $t_0$ corrisponde all'istante in cui l'istogramma inizia (per una discussione più completa riguardo a questo valore si rimanda al paragrafo~\cref{analisireale};
 \item $r$ è il range dell'istogramma (circa 4000 canali);
 \item $I$ e $b$ sono vincolati, in quanto uno sguardo approssimativo allo spettro reale suggerisce che una settimana di acquisizione corrisponde a circa 80000 eventi e a $b \ {\raise.17ex\hbox{$\scriptstyle\sim$}} \ 1 $.
\end{itemize}
Di seguito viene riportato un esempio di spettro generato e fittato come descritto.

\begin{figure}[h]
 \centerline{\includestandalone[width=\linewidth+1cm]{img/example_single_spectrum}}
 \caption{Esempio di istogramma simulato con statistica associata a 5 settimane di acquisizione (\textit{baseline} $\sim 5$) con sovrapposta la funzione di fit corrispondente. I parametri di input $\tau^+$, $\tau^-$ e R sono quelli della letteratura.}
 \label{fig::esempio_spettro_simulato}
\end{figure}
%
\subsection{Test multipli del metodo di fit}

Sino ad ora, si è testato e messo a punto il metodo di fit sulla base di spettri simulati con i valori attesi dei parametri, in particolare $\tau^+  \simeq 2.2  \ \mu s$ $(\sim 429$ canali$)$, $\tau^- \simeq 0.8 \  \mu s$ $(\sim 172$ canali$)$ e $R\simeq1.26$. 
In questa fase si intende testare il metodo su distribuzioni simulate con diversi valori di \textit{input}, anche senza alcun senso fisico: lo scopo è quello di avvalorarne la correttezza, verificando cioè che esso sia in grado di restituire in \textit{output} stime dei parametri compatibili con i valori messi in \textit{input} alle simulazioni. % evitando che, per esempio, esso dia stime dei parametri quelle sopra elencate seppur con valori in \textit{input} completamente diversi. 

La strategia adottata si sviluppa in due fasi:
\begin{enumerate}
 \item fissato un set di parametri di \textit{input}, si generano 500 spettri che vengono poi fittati con il metodo precedentemente descritto. Le stime dei parametri fornite dal fit e i relativi errori vengono immagazzinati all'interno di nuovi istogrammi; ci si aspetta che questi siano centrati attorno al valore del parametro inserito in \textit{input} alla simulazione. Tali istogrammi vengono riempiti esclusivamente dai fit che restituiscano stime dei parametri soddisfacenti le seguenti condizioni di qualità:
 \begin{enumerate}
  \item errore relativo inferiore al $20\%$;
  \item compatibilità con il valore atteso entro le $3\sigma$. 
 \end{enumerate}
 Se le stime del fit di uno spettro non soddisfano almeno una di queste condizioni per almeno uno dei parametri $\tau^+$, $\tau^-$ e $R$, nessuno degli istogrammi viene riempito per quella particolare simulazione, della qualche quindi non si mantiene memoria; si riporta un esempio in figura \ref{fig::esempio_set_simulazioni}.
 \begin{figure}
  \centering
  \begin{adjustbox}{width=\linewidth}
  \input{img/single}
  \end{adjustbox}
  \caption{Esempio di distribuzioni dei valori estatti dal fit dei singoli parametri e dei relativi errori, derivanti da 500 simulazioni con parametri settati ai valori fisici. Le linee verdi indicano il valore di ogni parametro messo in \textit{input} alle simulazioni. La statistica relativa ad ogni singolo spettro è comparabile con quella di 1 settimana di acquisizione ($ 80000$ eventi, \textit{baseline} $\sim 1$). L'efficienza finale del metodo per questa specifica simulazione è del $96.8\%$, il che vuol dire che in 16 (su 500) simulazioni almeno uno dei parametri non ha rispettato almeno una condizione di quelle elencate; per questo passaggio, non si è indagato quale parametro o quale condizione fallisse, ritenendosi soddisfatti dall'alta efficienza raggiunta.}
  \label{fig::esempio_set_simulazioni}
 \end{figure}
 
 \item Si ripete la procedura del punto precedente con \textit{sample} da 500 simulazioni ottenuti con parametri di \textit{input} di volta in volta diversi. Ogni \textit{sample} contribuisce all'efficienza complessiva sulla base dei valori di $\tau^+$, $\tau^-$ e $R$ corrispondenti ai centroidi delle distribuzioni dei valori, ai quali, come incertezza, si assegna il centroide della distribuzione degli errori associata. In particolare, le condizioni di qualità che si devono soddisfare sono:  
 \begin{enumerate}
  \item errore relativo inferiore al $20\%$;
  \item compatibilità con il valore atteso entro le $3\sigma$;
  \item dispersione ($\sigma$) della distribuzione dei parametri minore di 2 volte il centroide della distribuzione degli errori. Questo tipo di condizione avvalora la scelta del centroide della distribuzione degli errori come incertezza sul parametro: qualora esso fosse ordini di grandezza inferiore rispetto alla $\sigma$ della distribuzione dei valori, ciò implicherebbe la presenza di una componente di errore non controllata ( e sistematica).  
 \end{enumerate}
Qualora almeno una di queste condizioni non sia soddisfatta per almeno uno dei parametri $\tau^+$, $\tau^-$ e $R$ il \textit{sample} viene rigettato. In caso contrario, il \textit{sample} si considera valido. 
\end{enumerate}
Si è deciso di applicare la procedura descritta facendo variare i valori di \textit{input} dei parametri $\tau^+$, $\tau^-$, $R$ e $I$ (cioè corrispondentemente della \textit{baseline}) del $40\%$ attorno al valore fisico, per un totale di $3^4=81$ \textit{samples} rispetto ai quali calcolare l'efficienza. In virtù di quest test, si è prodotto il seguente grafico:
%
\begin{figure}[H]
  \centering
  \includestandalone[width=\linewidth+1cm]{img/notused/matrix_eff40}
  \caption{Efficienza del metodo per una variazione dei parametri del $40\%$ rispetto al valore fisico; si noti che ciò che più spesso fallisce è la stima di R.}
  \label{fig:finale}
\end{figure}
%
Prestando ulteriore attenzione, si sono osservate alcune criticità:
\begin{itemize}
 \item nel caso di \textit{samples} generati con valori di $\tau^+$ e $\tau^-$ ravvicinati, distanti circa $0.8 \ \mu s - 0.9 \ \mu s$), il metodo di fit fallisce, non riuscendo ad andare a convergenza. Questo problema riguarda comunque campioni di dati relativi a spettri senza alcun significato fisico (i muoni ``lunghi'' e ``corti'' non sono più tali);
 \item il parametro $R$ è quello più difficile da stimare correttamente, risultando determinante per rigettare alcuni \textit{samples} per i quali le stime di $\tau^+$ e $\tau^-$ risultano comunque valide.  
\end{itemize}
Per evidenziare queste criticità, si sono fatti variare i parametri in intervalli sempre più estesi (dal $10\%$ al $50\%$), producendo il seguente grafico: appare evidente come l'efficienza peggiori a mano a mano che il range di variazione aumenti, avallando l'ipotesi secondo la quale una efficienza non ottimale sia da ricondursi a parametri troppo distanti dai valori veri (e, per i $\tau$, troppo vicini tra loro) più che a difetti del codice. Rimane comunque evidente che R sia il parametro più problematico: ogni tentativo di miglioramento del metodo, come per esempio l'affinamento della scelta dei parametri da impostare con \lstinline{SetParameter} e l'impostazione di parametri aggiuntivi quali $A_+$ e $A_-$ nei fit preliminari, non è tuttavia riuscito a innalzare l'efficienza.
%
\begin{figure}[H]
  \centering
  \includestandalone[width=\linewidth+1cm]{img/matrix_5run}
  \caption{Efficienza del metodo per una variazione dei parametri dal $10 \%$ al $50\%$ rispetto al valore fisico; si noti l'andamento decrescente all'aumentare del range di variazione.}
  \label{fig:finale}
\end{figure}
%
%
\subsection{Studio del fattore di rebin} \label{parrebin}
Durante l'analisi, è stata presa in considerazione l'idea di applicare un'operazione di \textit{rebinning} (ovvero la fusione di un certo numero di canali, specificato dal \textit{fattore di rebin}, atta alla creazione di un unico bin che ha come altezza la somma delle precedenti) all'istogramma dei dati, originariamente costituito da 4096 canali, prima dell'operazione di fitting. Il metodo era stato adottato in precedenza (Sez.~\cref{analPrelim}) nell'ambito dell'analisi dati preliminare, e sembrava dare stabilità e maggiore precisione ai risultati del fit: la conseguenza principale del \textit{rebinning} è infatti quella di smorzare le fluttuazioni statistiche, e perciò l'efficacia dell'operazione ai fini del processo di analisi dei dati deve essere sistematicamente investigata.

Innanzitutto, si è applicato l'algoritmo a simulazioni Monte Carlo convergenti e accurate con valori del fattore di rebin pari a 2, 4, 8, 16, non riscontrando miglioramenti evidenti nella ricostruzione dei paramentri di fit, nonché nella larghezza delle loro distribuzioni. Si è quindi proceduto a verificare l'eventualità in cui un'operazione di \textit{rebinning} possa rendere convergente un fit non convergente, attestando anche in questo frangente una sostanziale ininfluenza del metodo.

In conclusione si può tranquillamente assumere l'operazione di \textit{rebinning} come assolutamente ininfluente ai fini dell'analisi dati.
%
\section{Analisi dello spettro reale} \label{analisireale}
Il campione di dati corrisponde agli eventi raccolti in 33 giorni di acquisizione, per un totale di 375241 eventi (frequenza $ {\raise.17ex\hbox{$\scriptstyle\sim$}} \ 0.13$ Hz). I risultati sono presentati in tabella \ref{risultatiFinali} e in figura~\ref{fig:finale}.

L'ultimo punto lasciato in sospeso è la questione, menzionata alla sezione \ref{tac}, dell'eccesso di eventi registrato con le coincidenze artificiali nel range $[2200,2700]$ canali; nell'istogramma finale non si nota alcuna sovrabbondanza di eventi nel suddetto range. In ogni caso, sono stati tentati due approcci per tenerne conto nell'analisi dati:
\begin{enumerate}
  \item \textbf{esclusione dal fit,} ovvero si è costruita una funzione di fit alternativa definita a tratti tramite \lstinline{TF1::RejectPoint} che esclude i punti dal calcolo della likelihood;
  \item \textbf{errori incrementati,} ovvero si è provato a attribuire errori maggiori ai punti nel range, ad esempio il doppio rispetto all'errore poissoniano standard.
\end{enumerate}
Nessuno dei due metodi ha portato a un miglioramento significativo dei risultati finali.
%
\begin{table}[H]
	\centering
	\begin{tabular}{cccc}
		\toprule
				& Misura	& Valore atteso 	& Compatibilità \\	
		\midrule
		$\tau^+$	& $(2.18 \pm 0.02) \ \mu \mbox{s}$ 	& $(2.1969811 \pm 0.0000022) \  \mu \mbox{s}$ 	& 0.64 	\\
		$\tau^-$	& $(0.85 \pm 0.04)  \ \mu \mbox{s}$ 	& $(0.8646 \pm 0.0012)  \ \mu \mbox{s}$ 		& 0.36	\\
		$N^+/N^-$	& $1.80 \pm 0.09$ 	& $1.261 \pm 0.009$ 		& 6.10	\\
		\bottomrule
	\end{tabular}
	\caption{Risultati.}
	\label{risultatiFinali}
\end{table}
%
\begin{figure}[H]
 \centerline{%
  \includestandalone[width=\linewidth+2cm]{img/finaleres}}
  \caption{Risultato del fit, in basso il grafico dei residui.}
  \label{fig:finale}
\end{figure}
%
\section{Discussione dei risultati}

La tabella~\ref{risultatiFinali} mostra come, a fronte di un'ottima compatibilità per i valori dei $\tau$ rispetto a quelli attesi, R risulti notevolmente sovrastimato: avendo già escluso che ciò possa essere in qualche modo influenzato dallo spettro raccolto (o dal metodo di analisi), è stato effettuato un tentativo di analisi dell'energia delle partucelle incidenti.

Infatti, R dipende dall'energia dei muoni incidenti\footnote{T.~K. Gaisser, \emph{Spectrum of cosmic-ray nucleons, kaon production, and the atmospheric muon charge ratio}, Astropart.Phys., \textbf{35}, 801-806 (2012).}, ed è possibile inferire che per avere un valore attorno a 1.6, compatibile con quello ottenuto in tabella~\ref{risultatiFinali}, $E_{\mu} \sim 10$ TeV: tuttavia, per frenare un muone di tale energia con del piombo\footnote{J. Beringer et alii, \emph{Particle Data Group}, PR \textbf{D86}, 010001 (2012)}, prendendo come densità $ \rho_{Pb} = 11.3 $ g/cm$^3$, servirebbero quasi 5 km di spessore, che ovviamente non sono disponibili in laboratorio. Per questo motivo, si scarta anche questa ipotesi. %lasciando aperta l'unica possibilità che tale discrepanza dipenda dall'apparato di raccolta dati, come gli scintillatori

\appendix
%\setcounter{secnumdepth}{0}
\include{analApp}
\include{imgEff}
\end{document}
